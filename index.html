<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Ù…ÙØ§Ø¬Ø£ØªÙŠ Ø§Ù„ÙŠÙˆÙ…ÙŠØ© Ù„Ø®Ø·ÙŠØ¨ØªÙŠ</title>
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@700&family=Amiri:wght@700&display=swap" rel="stylesheet">
    <style>
        :root { 
            --bg-color: #2e004e; 
            --accent: #e0aaff; 
        }
        
        body { 
            margin: 0; height: 100vh; display: flex; justify-content: center; align-items: center; 
            background: var(--bg-color); transition: background 1.5s ease; 
            font-family: 'Cairo', sans-serif; overflow: hidden; color: white;
        }
        
        #lock-screen { 
            position: fixed; top: 0; left: 0; width: 100%; height: 100%; 
            background: #1a0033; display: flex; flex-direction: column; 
            justify-content: center; align-items: center; z-index: 100; transition: 0.8s ease; 
        }
        
        .lock-box { text-align: center; padding: 20px; }
        .lock-box input { 
            padding: 15px; border-radius: 15px; border: 2px solid var(--accent); 
            background: rgba(255,255,255,0.1); color: white; text-align: center; 
            font-size: 1.5rem; width: 180px; outline: none; margin-top: 15px;
        }

        .main-content { 
            display: none; text-align: center; width: 100%; max-width: 400px; 
            animation: fadeIn 1.2s ease-out; 
        }
        
        @keyframes fadeIn { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }
        
        h1 { color: white; margin-bottom: 20px; text-shadow: 0 4px 10px rgba(0,0,0,0.3); }
        
        .scratch-container { 
            position: relative; width: 320px; height: 220px; margin: 0 auto; 
            background: #fff; border-radius: 25px; box-shadow: 0 20px 50px rgba(0,0,0,0.5); 
            overflow: hidden; 
        }
        
        .message-under { 
            position: absolute; width: 100%; height: 100%; display: flex; 
            justify-content: center; align-items: center; padding: 25px; 
            box-sizing: border-box; text-align: center; color: #301934; 
            font-family: 'Amiri', serif; font-size: 1.4rem; line-height: 1.6;
        }
        
        #scratch-canvas { position: absolute; top: 0; left: 0; touch-action: none; border-radius: 25px; cursor: crosshair; }
        .hint { color: var(--accent); margin-top: 25px; font-size: 0.9rem; animation: pulse 2s infinite; }
        @keyframes pulse { 0%, 100% { opacity: 0.5; } 50% { opacity: 1; } }
        .error { color: #ff4d6d; margin-top: 10px; display: none; font-size: 0.9rem; }
    </style>
</head>
<body>

    <div id="lock-screen">
        <div class="lock-box">
            <div style="font-size: 60px; margin-bottom: 10px;">ğŸ”</div>
            <h2 id="status-text">Ø¬Ø§Ø±ÙŠ Ù…Ø²Ø§Ù…Ù†Ø© Ø±Ø³Ø§Ù„ØªÙƒÙ...</h2>
            <input type="password" id="pass-input" placeholder="ÙƒÙ„Ù…Ø© Ø§Ù„Ø³Ø±" disabled>
            <p id="error-msg" class="error">ÙƒÙ„Ù…Ø© Ø§Ù„Ø³Ø± Ø®Ø§Ø·Ø¦Ø© ÙŠØ§ Ø­Ø¨ÙŠØ¨ØªÙŠ</p>
        </div>
    </div>

    <div class="main-content" id="main-content">
        <h1 id="daily-title">Ø¹Ù†ÙˆØ§Ù† Ø§Ù„ÙŠÙˆÙ…</h1>
        <div class="scratch-container">
            <div class="message-under">
                <p id="daily-message"></p>
            </div>
            <canvas id="scratch-canvas" width="320" height="220"></canvas>
        </div>
        <p class="hint">Ø§Ù‚Ø´Ø·ÙŠ Ø§Ù„ÙƒØ±Øª Ø¨Ø¥ØµØ¨Ø¹ÙƒÙ Ù„Ø±Ø¤ÙŠØ© Ø§Ù„Ù…ÙØ§Ø¬Ø£Ø© âœ¨</p>
    </div>

    <script>
        // Ø§Ù„Ø±Ø§Ø¨Ø· Ø§Ù„Ù…Ø´ÙØ± Ø§Ù„Ø®Ø§Øµ Ø¨Ùƒ
        const ENCODED_URL = "aHR0cHM6Ly9kb2NzLmdvb2dsZS5jb20vc3ByZWFkc2hlZXRzL2QvZS8yUEFDWC0xdlI1ZkM3dVRBenU2MW9BMVdZVzQ0T29OME02eWZpX2pvMXlBMXc3MUlKQWZKZnRtWGJmakpMNVBLbXNSUURkTld3Y295WFRHUGNCOFRUaS9wdWI/Z2lkPTAmc2luZ2xlPXRydWUmb3V0cHV0PWNzdg=="; 
        
        let decoded = atob(ENCODED_URL);
        // ØªØ­ÙˆÙŠÙ„ Ø§Ù„Ø±Ø§Ø¨Ø· ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹ Ù„ÙŠÙƒÙˆÙ† CSV ØµØ§Ù„Ø­ Ù„Ù„ØªØ­Ù…ÙŠÙ„
        const CSV_URL = decoded.replace('/pubhtml', '/pub?output=csv');

        let correctPass = "";
        
        // Ø¬Ù„Ø¨ ØªØ§Ø±ÙŠØ® Ø§Ù„ÙŠÙˆÙ… Ø¨ØµÙŠØºØ© YYYY-MM-DD
        const now = new Date();
        const year = now.getFullYear();
        const month = String(now.getMonth() + 1).padStart(2, '0');
        const day = String(now.getDate()).padStart(2, '0');
        const todayStr = `${year}-${month}-${day}`;

        async function loadData() {
            try {
                // Fetch Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ø¹ ØªØ¬Ù†Ø¨ Ø§Ù„Ù€ Cache Ù„Ø¶Ù…Ø§Ù† Ø§Ù„ØªØ­Ø¯ÙŠØ« Ø§Ù„ÙŠÙˆÙ…ÙŠ
                const response = await fetch(CSV_URL + '&t=' + new Date().getTime());
                if (!response.ok) throw new Error();
                
                const data = await response.text();
                const rows = data.split('\n').map(row => row.split(',').map(c => c.trim().replace(/"/g, '')));
                
                // Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† ØªØ§Ø±ÙŠØ® Ø§Ù„ÙŠÙˆÙ… ÙÙŠ Ø§Ù„Ø¹Ù…ÙˆØ¯ Ø§Ù„Ø£ÙˆÙ„
                const todayData = rows.find(row => row[0] === todayStr);

                if (todayData) {
                    correctPass = todayData[1]; 
                    document.getElementById('daily-title').innerText = todayData[2]; 
                    document.getElementById('daily-message').innerText = todayData[3]; 
                    document.getElementById('status-text').innerText = "Ø£Ø¯Ø®Ù„ÙŠ ÙƒÙ„Ù…Ø© Ø§Ù„Ø³Ø± Ù„ÙØªØ­ Ø§Ù„ØµÙ†Ø¯ÙˆÙ‚";
                    document.getElementById('pass-input').disabled = false;
                } else {
                    document.getElementById('status-text').innerText = "Ù„Ø§ ØªÙˆØ¬Ø¯ Ø±Ø³Ø§Ù„Ø© Ù…Ø¨Ø±Ù…Ø¬Ø© Ù„Ù‡Ø°Ø§ Ø§Ù„ØªØ§Ø±ÙŠØ®: " + todayStr;
                }
            } catch (e) {
                document.getElementById('status-text').innerText = "Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø§ØªØµØ§Ù„.. ØªØ£ÙƒØ¯ÙŠ Ù…Ù† 'Ù†Ø´Ø±' Ø§Ù„Ù…Ù„Ù ÙƒÙ€ CSV";
            }
        }

        document.getElementById('pass-input').addEventListener('input', function() {
            if (this.value === correctPass) {
                document.getElementById('lock-screen').style.transform = 'translateY(-100%)';
                setTimeout(() => {
                    document.getElementById('lock-screen').style.display = 'none';
                    document.getElementById('main-content').style.display = 'block';
                    initScratchCard();
                }, 800);
            } else if (this.value.length >= String(correctPass).length && this.value !== String(correctPass)) {
                document.getElementById('error-msg').style.display = 'block';
                setTimeout(() => { 
                    document.getElementById('error-msg').style.display = 'none'; 
                    this.value = ''; 
                }, 1000);
            }
        });

        const dailyColors = ['#2e004e', '#4b0082', '#6a0dad', '#800080', '#3c096c', '#5a189a', '#240046'];
        document.documentElement.style.setProperty('--bg-color', dailyColors[new Date().getDay()]);

        const canvas = document.getElementById('scratch-canvas');
        const ctx = canvas.getContext('2d');
        let isDrawing = false;

        function initScratchCard() {
            const grad = ctx.createLinearGradient(0, 0, 320, 220);
            grad.addColorStop(0, '#c3a1ff'); 
            grad.addColorStop(1, '#7b2cbf');
            ctx.fillStyle = grad;
            ctx.fillRect(0, 0, 320, 220);
            ctx.fillStyle = "white";
            ctx.font = "bold 20px Cairo";
            ctx.textAlign = "center";
            ctx.fillText("Ø§Ù‚Ø´Ø·ÙŠ Ù‡Ù†Ø§ ğŸ’œ", 160, 115);
        }

        function scratch(e) {
            if (!isDrawing) return;
            const rect = canvas.getBoundingClientRect();
            const clientX = e.touches ? e.touches[0].clientX : e.clientX;
            const clientY = e.touches ? e.touches[0].clientY : e.clientY;
            const x = clientX - rect.left;
            const y = clientY - rect.top;
            ctx.globalCompositeOperation = 'destination-out';
            ctx.beginPath(); ctx.arc(x, y, 25, 0, Math.PI * 2); ctx.fill();
        }

        canvas.addEventListener('mousedown', () => isDrawing = true);
        canvas.addEventListener('touchstart', () => isDrawing = true);
        window.addEventListener('mouseup', () => isDrawing = false);
        window.addEventListener('touchend', () => isDrawing = false);
        canvas.addEventListener('mousemove', scratch);
        canvas.addEventListener('touchmove', scratch);

        loadData();
    </script>
</body>
</html>
